# Hangry CPU

Proposed difficulty: `Medium`

39 solves

```text
Broooo du tror det ikke!! Din CPU har spist flaget, og jeg skulle ellers lige til at give det til dig...
Legenden siger at hvis du spiser hvidløg så forsvinder vampyrerne, men de siger også at du kan bruge GDB til at tjekke din CPUs mave. Lækkert ikke?
Nårh, men hils CPU'en fra mig og sig til den at den skal give mig mine barbecue chips tilbage.
```

Attachments:

`chall: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5bede9cb7cb1326ced67179c995bd5537594c2a2, for GNU/Linux 3.2.0, not stripped`

# Solution

I ran `readelf -a chall`, and saw an interesting symbol called breakHere.

So I opened the binary in `pwndbg`, and set a breakpoint at that symbol, and proceeded to run the binary.

```text
pwndbg> break breakHere
Breakpoint 1 at 0x401352
pwndbg> run

         #####   #####   #####   #####         
         ## ###  ## ##   ## ##  ### ##         
       #################################       
     #####################################     
    ###                                 ###    
#######                                 #######
#######    ####      ######      ###    #######
 ######    ##### ############## #####   ###### 
    ###    ########          ########   ###    
#######    #########        ## ######   #######
#######     ###  ######  #####  ####    #######
#######    ###     #### #####    ###    #######
    ###    ###     ###    ###     ##    ###    
 ######    ###  ###         ###   ##    #######
#######    ###   #####    ####   ###    #######
#######     ###    #########     ###    #######
    ###     ####               ####     ###    
 ######       ####           #####      ###### 
#######         ################        #######
#######            #########            #######
    ###                                 ###    
     #####################################     
       #################################       
         ## ###  ## ##   ## ##  ### ##         
         #####   #####   #####   #####   
Sorry i dont have a flag for you.
Your hangry CPU ate my flag!
I might have an idea of how to get it back, but we have to be hurry! 
You have to travel into the cpu and read it, before it's fully processed. 
I will tell you when to stop it, it should be in the registers.
3..
2..
1..

Breakpoint 1, 0x0000000000401352 in breakHere ()
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
──────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────
 RAX  0x0
*RBX  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*RCX  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*RDX  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
 RDI  0x0
 RSI  0x0
*R8   0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R9   0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R10  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R11  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R12  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R13  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R14  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*R15  0x7fffffffcf90 ◂— 'DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}'
*RBP  0x7fffffffd0b0 —▸ 0x7fffffffd0c0 ◂— 0x1
*RSP  0x7fffffffd0b0 —▸ 0x7fffffffd0c0 ◂— 0x1
*RIP  0x401352 (breakHere+8) ◂— lea rdi, [rip + 0x115b]
───────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────
 ► 0x401352 <breakHere+8>     lea    rdi, [rip + 0x115b]
   0x401359 <breakHere+15>    call   printLineByCharector                      <printLineByCharector>
 
   0x40135e <breakHere+20>    nop    
   0x40135f <breakHere+21>    pop    rbp
   0x401360 <breakHere+22>    ret    
 
   0x401361 <main>            endbr64 
   0x401365 <main+4>          push   rbp
   0x401366 <main+5>          mov    rbp, rsp
   0x401369 <main+8>          mov    eax, 0
   0x40136e <main+13>         call   printAsciiCPU                      <printAsciiCPU>
 
   0x401373 <main+18>         mov    edi, 0x7a120
────────────────────────────────────────────────────────────────[ STACK ]─────────────────────────────────────────────────────────────────
00:0000│ rbp rsp 0x7fffffffd0b0 —▸ 0x7fffffffd0c0 ◂— 0x1
01:0008│+008     0x7fffffffd0b8 —▸ 0x401441 (main+224) ◂— mov eax, 0
02:0010│+010     0x7fffffffd0c0 ◂— 0x1
03:0018│+018     0x7fffffffd0c8 —▸ 0x7ffff7dd3cd0 ◂— mov edi, eax
04:0020│+020     0x7fffffffd0d0 —▸ 0x7fffffffd1c0 —▸ 0x7fffffffd1c8 ◂— 0x38 /* '8' */
05:0028│+028     0x7fffffffd0d8 —▸ 0x401361 (main) ◂— endbr64 
06:0030│+030     0x7fffffffd0e0 ◂— 0x100400040 /* '@' */
07:0038│+038     0x7fffffffd0e8 —▸ 0x7fffffffd1d8 —▸ 0x7fffffffd63c ◂— '/root/bruh/moment'
──────────────────────────────────────────────────────────────[ BACKTRACE ]───────────────────────────────────────────────────────────────
 ► 0         0x401352 breakHere+8
   1         0x401441 main+224
   2   0x7ffff7dd3cd0
   3   0x7ffff7dd3d8a __libc_start_main+138
   4         0x4010fe _start+46
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
```

The flag is in a lot of registers when breaking at that point.

# Flag

`DDC{Br0W51Ng_7Hr0UgH_r3g1573r5}`
